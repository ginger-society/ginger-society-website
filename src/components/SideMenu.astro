---
const { menuItems } = Astro.props;
---

<style>
  .sideMenu {
    max-width: 250px;
    width: 100%;
    background-color: #f8f9fa;
    padding: 20px;
    border-right: 1px solid #ddd;
    position: sticky;
    top: 20px;
    height: fit-content;
  }

  .menuItem {
    margin-bottom: 10px;
  }

  .menuLink {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    color: #333;
    text-decoration: none;
    font-weight: bold;
  }

  .menuLink:hover {
    background-color: #e9ecef;
  }

  .subMenu {
    padding-left: 15px;
    margin-top: 5px;
  }

  .subMenuItem {
    margin: 5px 0;
  }

  .subMenuItem a {
    color: #555;
    text-decoration: none;
  }

  .subMenuItem a:hover {
    color: #000;
    text-decoration: underline;
  }

  .toggleIcon {
    font-size: 12px;
    transition: transform 0.3s;
  }

  .expanded .toggleIcon {
    transform: rotate(90deg);
  }

  .menu__list-item-collapsible {
    cursor: pointer;
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const collapsibles = document.querySelectorAll(
      ".menu__list-item-collapsible"
    );
    collapsibles.forEach((item) => {
      item.addEventListener("click", () => {
        const subMenu = item.nextElementSibling;
        if (subMenu) {
          subMenu.classList.toggle("expanded");
        }
      });
    });
  });
</script>

<div class="sideMenu">
  {
    menuItems.map((item) => (
      <div class="menuItem">
        <div class="menu__list-item-collapsible">
          <a class="menuLink">
            {item.title}
            {item.subMenu && <span class="toggleIcon">â–¸</span>}
          </a>
        </div>
        {item.subMenu && (
          <ul class="subMenu">
            {item.subMenu.map((subItem) => (
              <li class="subMenuItem">
                <a
                  href={subItem.link}
                  target={subItem.external ? "_blank" : "_self"}
                  rel={subItem.external ? "noopener noreferrer" : ""}
                >
                  {subItem.title}
                </a>
              </li>
            ))}
          </ul>
        )}
      </div>
    ))
  }
</div>
